# TURN Server Configuration for LiveKit - SSL OPTIMIZED
# Provides NAT traversal for WebRTC connections with proper TLS

# Listening port for TURN/STUN
listening-port=3478

# TLS listening port
tls-listening-port=5349

# Listening IPs
listening-ip=0.0.0.0

# TURN relay IPs
relay-ip=0.0.0.0

# Server realm
realm=lk-turn.delo.sh

# Enable long-term credentials mechanism
use-auth-secret
static-auth-secret=${TURN_SECRET:-livekit-turn-secret}

# Certificate files for TLS (Let's Encrypt certificates from Traefik)
# These will be automatically available once certificates are issued
cert=/ssl-certs/acme.json
pkey=/ssl-certs/acme.json

# Security options
no-software-attribute
no-rfc5780
fingerprint

# Log configuration
log-file=stdout
verbose

# Database configuration (using Redis if available)
# redis-userdb="ip=redis port=6379 dbname=0 connect_timeout=30"

# Max session time in seconds (12 hours)
max-session-time 43200

# Disable multicast listeners for security
no-multicast-peers

# Enable mobility for better WebRTC support
mobility

# Disable UDP relay endpoints for better security
# Comment out if you need UDP relay
# no-udp-relay

# Enable STUN
stun-only=false

# TURN over TLS configuration
ca-file /etc/ssl/certs/ca-certificates.crt
cipher-list "ECDH+AESGCM:ECDH+CHACHA20:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:RSA+AESGCM:RSA+AES:!aNULL:!MD5:!DSS"
